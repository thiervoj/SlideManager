"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),SlideManager=function(){function t(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),i?e.callback?(this.el=i,this.changing=!1,this.index=0,this.max=e.length||this.el.children.length,this.options={loop:e.loop||!1,random:e.random||!1,vertical:e.vertical||!1,callback:e.callback,auto:e.auto||!1,interval:e.interval||5,init:e.init||!1,swipe:!1!==e.swipe||e.swipe,threshold:e.threshold||60},e.startAt!==this.index&&e.startAt>0&&(e.startAt>this.max?this.index=this.max:this.index=e.startAt),this.counter=0,this.raf=null,this.paused=!1,this.touch={startX:0,startY:0,endX:0,endY:0},this.options.swipe&&this.events(),this.options.init&&this.init()):console.error("You must give a callback"):console.error("You must pass an element")}return _createClass(t,[{key:"init",value:function(){return 0===this.max?null:(this.options.auto&&this.startAuto(),this)}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"destroy",value:function(){return 0===this.max?null:(this.changing=!1,this.options.swipe&&(this.el.removeEventListener("mousedown",this.touchStart,!1),this.el.removeEventListener("mouseup",this.touchEnd,!1),this.el.removeEventListener("touchstart",this.touchStart,!1),this.el.removeEventListener("touchend",this.touchEnd,!1)),cancelAnimationFrame(this.raf),this.raf=null,this.counter=0,this)}},{key:"getIndex",value:function(){return this.index}},{key:"goTo",value:function(t){if(t!==this.index&&!this.isChanging()){var i=this.checkLoop(t),e=this.createEvent(i);i!==this.index?(this.index=i,this.options.callback(e)):this.changing=!1}}},{key:"done",value:function(){this.changing=!1}},{key:"events",value:function(){this.el.addEventListener("mousedown",this.touchStart.bind(this),!1),this.el.addEventListener("mouseup",this.touchEnd.bind(this),!1),this.el.addEventListener("touchstart",this.touchStart.bind(this),!1),this.el.addEventListener("touchend",this.touchEnd.bind(this),!1)}},{key:"touchStart",value:function(t){this.touch.startX="touchstart"===t.type?t.touches[0].screenX:t.screenX,this.touch.startY="touchstart"===t.type?t.touches[0].screenY:t.screenY}},{key:"touchEnd",value:function(t){this.touch.endX="touchend"===t.type?t.changedTouches[0].screenX:t.screenX,this.touch.endY="touchend"===t.type?t.changedTouches[0].screenY:t.screenY,this.handleSwipe()}},{key:"handleSwipe",value:function(){this.options.vertical?(this.touch.endY<this.touch.startY&&this.touch.startY-this.touch.endY>=this.options.threshold&&(this.touch.endX<this.touch.startX&&this.touch.startX-this.touch.endX<=100||this.touch.endX>this.touch.startX&&this.touch.endX-this.touch.startX<=100)&&this.callback(1),this.touch.endY>this.touch.startY&&this.touch.endY-this.touch.startY>=this.options.threshold&&(this.touch.endX<this.touch.startX&&this.touch.startX-this.touch.endX<=100||this.touch.endX>this.touch.startX&&this.touch.endX-this.touch.startX<=100)&&this.callback(-1)):(this.touch.endX<this.touch.startX&&this.touch.startX-this.touch.endX>=this.options.threshold&&(this.touch.endY<this.touch.startY&&this.touch.startY-this.touch.endY<=100||this.touch.endY>this.touch.startY&&this.touch.endY-this.touch.startY<=100)&&this.callback(-1),this.touch.endX>this.touch.startX&&this.touch.endX-this.touch.startX>=this.options.threshold&&(this.touch.endY<this.touch.startY&&this.touch.startY-this.touch.endY<=100||this.touch.endY>this.touch.startY&&this.touch.endY-this.touch.startY<=100)&&this.callback(1))}},{key:"startAuto",value:function(){this.paused||++this.counter>=60*this.options.interval&&(this.callback(-1),this.counter=0),this.raf=requestAnimationFrame(this.startAuto.bind(this))}},{key:"isChanging",value:function(){return!!this.changing||(this.changing=!0,!1)}},{key:"newIndex",value:function(t){return this.checkLoop(t>0?this.index-1:this.index+1)}},{key:"newRandomIndex",value:function(){var t=void 0;do{t=Math.floor(Math.random()*this.max)}while(t===this.index);return t}},{key:"checkLoop",value:function(t){return t<0?this.options.loop?this.max-1:0:t>this.max-1?this.options.loop?0:this.max-1:t}},{key:"createEvent",value:function(t){var i=t>this.index?1:-1;return 0===this.index&&t===this.max?i=-1:this.index===this.max&&0===t&&(i=1),{current:t,previous:this.index,direction:i}}},{key:"callback",value:function(t){if(!this.isChanging()){var i=this.options.random?this.newRandomIndex():this.newIndex(t),e=this.createEvent(i);i!==this.index?(this.index=i,this.options.callback(e)):this.changing=!1}}}]),t}();exports.default=SlideManager;
