"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,i){for(var s=0;s<i.length;s++){var h=i[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(t,h.key,h)}}return function(i,s,h){return s&&t(i.prototype,s),h&&t(i,h),i}}(),SlideManager=exports.SlideManager=function(){function t(i){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),i?s.callback?(this.el=i,this.changing=!1,this.index=0,this.max=s.length||this.el.children.length,this.threshold=s.threshold||60,this.options={loop:s.loop||!1,random:s.random||!1,vertical:s.vertical||!1,callback:s.callback,auto:s.auto||!1,interval:s.interval||5,init:!1!==s.init,swipe:!1!==s.swipe},s.startAt!=this.index&&s.startAt>0&&(s.startAt>this.max?this.index=this.max:this.index=s.startAt),this.onSwipe=this.onSwipe.bind(this),this.counter=0,this.raf=null,this.touch={startX:0,startY:0,endX:0,endY:0},this.options.swipe&&this.events(),this.options.init&&this.init()):console.error("You must give a callback"):console.error("You must pass an element")}return _createClass(t,[{key:"init",value:function(){if(0!==this.max)return this.options.auto&&this.startAuto(),this}},{key:"destroy",value:function(){if(0!==this.max)return this.changing=!1,this.options.swipe&&(this.el.removeEventListener("mousedown",this.touchStart,!1),this.el.removeEventListener("mouseup",this.touchEnd,!1),this.el.removeEventListener("touchstart",this.touchStart,!1),this.el.removeEventListener("touchend",this.touchEnd,!1)),cancelAnimationFrame(this.raf),this.raf=null,this.counter=0,this}},{key:"getIndex",value:function(){return this.index}},{key:"goTo",value:function(t){if(t!=this.index&&!this.isChanging()){var i=this.checkLoop(t),s=this.createEvent(i);i!=this.index?(this.index=i,this.options.callback(s)):this.changing=!1}}},{key:"done",value:function(){this.changing=!1}},{key:"events",value:function(){this.el.addEventListener("mousedown",this.touchStart.bind(this),!1),this.el.addEventListener("mouseup",this.touchEnd.bind(this),!1),this.el.addEventListener("touchstart",this.touchStart.bind(this),!1),this.el.addEventListener("touchend",this.touchEnd.bind(this),!1)}},{key:"touchStart",value:function(t){this.touch.startX=t.screenX,this.touch.startY=t.screenY}},{key:"touchEnd",value:function(t){this.touch.endX=t.screenX,this.touch.endY=t.screenY,this.handleSwipe()}},{key:"handleSwipe",value:function(){this.options.vertical?(this.touch.endY<this.touch.startY&&this.touch.startY-this.touch.endY>=this.threshold&&(this.touch.endX<this.touch.startX&&this.touch.startX-this.touch.endX<=100||this.touch.endX>this.touch.startX&&this.touch.endX-this.touch.startX<=100)&&this.callback(1),this.touch.endY>this.touch.startY&&this.touch.endY-this.touch.startY>=this.threshold&&(this.touch.endX<this.touch.startX&&this.touch.startX-this.touch.endX<=100||this.touch.endX>this.touch.startX&&this.touch.endX-this.touch.startX<=100)&&this.callback(-1)):(this.touch.endX<this.touch.startX&&this.touch.startX-this.touch.endX>=this.threshold&&(this.touch.endY<this.touch.startY&&this.touch.startY-this.touch.endY<=100||this.touch.endY>this.touch.startY&&this.touch.endY-this.touch.startY<=100)&&this.callback(-1),this.touch.endX>this.touch.startX&&this.touch.endX-this.touch.startX>=this.threshold&&(this.touch.endY<this.touch.startY&&this.touch.startY-this.touch.endY<=100||this.touch.endY>this.touch.startY&&this.touch.endY-this.touch.startY<=100)&&this.callback(1))}},{key:"startAuto",value:function(){++this.counter>=60*this.options.interval&&(this.callback(-1),this.counter=0),this.raf=requestAnimationFrame(this.startAuto.bind(this))}},{key:"isChanging",value:function(){return!!this.changing||(this.changing=!0,!1)}},{key:"onSwipe",value:function(t){this.callback(this.options.vertical?t.deltaY:t.deltaX)}},{key:"newIndex",value:function(t){return this.checkLoop(t>0?this.index-1:this.index+1)}},{key:"newRandomIndex",value:function(){var t=void 0;do{t=Math.floor(Math.random()*this.max)}while(t==this.index);return t}},{key:"checkLoop",value:function(t){return t<0?this.options.loop?this.max-1:0:t>this.max-1?this.options.loop?0:this.max-1:t}},{key:"createEvent",value:function(t){var i=t>this.index?1:-1;return 0==this.index&&t==this.max?i=-1:this.index==this.max&&0==t&&(i=1),{current:t,previous:this.index,direction:i}}},{key:"callback",value:function(t){if(!this.isChanging()){var i=this.options.random?this.newRandomIndex():this.newIndex(t),s=this.createEvent(i);i!=this.index?(this.index=i,this.options.callback(s)):this.changing=!1}}}]),t}();
