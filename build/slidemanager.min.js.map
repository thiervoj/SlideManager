{"version":3,"file":"slidemanager.min.js","sources":["../src/raf-interval.js","../src/slidemanager.js"],"sourcesContent":["const queue = []\r\nlet id = -1\r\nlet ticking = false\r\nlet tickId = null\r\n\r\nexport const setRafInterval = (fn, interval) => {\r\n  id++\r\n\r\n  queue.push({\r\n    id,\r\n    fn,\r\n    interval,\r\n    lastTime: performance.now()\r\n  })\r\n\r\n  if (!ticking) {\r\n    const tick = () => {\r\n      tickId = requestAnimationFrame(tick)\r\n\r\n      queue.forEach((item) => {\r\n        if (item.interval < 17 || performance.now() - item.lastTime >= item.interval) {\r\n          item.fn()\r\n          item.lastTime = performance.now()\r\n        }\r\n      })\r\n    }\r\n\r\n    ticking = true\r\n\r\n    tick()\r\n  }\r\n\r\n  return id\r\n}\r\n\r\nexport const clearRafInterval = (rafID) => {\r\n  for (let i = 0; i < queue.length; i++) {\r\n    if (rafID === queue[i].id) {\r\n      queue.splice(i, 1)\r\n\r\n      break\r\n    }\r\n  }\r\n\r\n  if (queue.length === 0) {\r\n    cancelAnimationFrame(tickId)\r\n\r\n    ticking = false\r\n  }\r\n}\r\n","import { setRafInterval, clearRafInterval } from './raf-interval'\r\n\r\nexport default class Slidemanager {\r\n  constructor(opt = {}) {\r\n    if (!opt.callback) {\r\n      console.warn('Slidemanager: Missing `callback` property in constructor.')\r\n\r\n      return\r\n    }\r\n\r\n    if (this.max === -1) {\r\n      console.warn('Slidemanager: Missing `el` or `length` property in constructor.')\r\n\r\n      return\r\n    }\r\n\r\n    this.bindMethods()\r\n\r\n    const defaults = {\r\n      el: null,\r\n      loop: false,\r\n      random: false,\r\n      vertical: false,\r\n      callback: this.done,\r\n      auto: false,\r\n      interval: 5,\r\n      init: true,\r\n      swipe: true,\r\n      mouseSwipe: false,\r\n      startAt: 0,\r\n      threshold: 60\r\n    }\r\n\r\n    this.options = Object.assign(defaults, opt)\r\n\r\n    this.el = opt.el\r\n    this.changing = false\r\n    this.max = opt.length > 0 ? opt.length : opt.el && opt.el.children ? opt.el.children.length : -1\r\n    this.index = !isNaN(opt.startAt) && opt.startAt !== defaults.startAt ? Math.max(0, Math.min(opt.startAt, this.max)) : 0\r\n\r\n    this.intervalID = null\r\n\r\n    this.touch = {\r\n      startX: 0,\r\n      startY: 0,\r\n      endX: 0,\r\n      endY: 0\r\n    }\r\n\r\n    this.diagonalMax = 125\r\n\r\n    if (this.options.init) this.init()\r\n  }\r\n\r\n  bindMethods() {\r\n    this.intervalFn = this.intervalFn.bind(this)\r\n    this.startAuto = this.startAuto.bind(this)\r\n    this.stopAuto = this.stopAuto.bind(this)\r\n    this.touchStart = this.touchStart.bind(this)\r\n    this.touchEnd = this.touchEnd.bind(this)\r\n    this.done = this.done.bind(this)\r\n  }\r\n\r\n  // Public functions\r\n  init() {\r\n    if (this.max === 0) return null\r\n\r\n    if (this.options.auto) this.startAuto()\r\n\r\n    if (this.options.swipe) this.events()\r\n\r\n    return this\r\n  }\r\n\r\n  destroy() {\r\n    if (this.max === 0) return null\r\n\r\n    this.changing = false\r\n\r\n    if (this.options.swipe && this.el) {\r\n      if (this.options.mouseSwipe) {\r\n        this.el.removeEventListener('mousedown', this.touchStart)\r\n        this.el.removeEventListener('mouseup', this.touchEnd)\r\n      }\r\n\r\n      this.el.removeEventListener('touchstart', this.touchStart)\r\n      this.el.removeEventListener('touchend', this.touchEnd)\r\n    }\r\n\r\n    if (this.options.auto) this.stopAuto()\r\n\r\n    return this\r\n  }\r\n\r\n  getIndex() {\r\n    return this.index\r\n  }\r\n\r\n  prev() {\r\n    this.goTo(this.index - 1)\r\n  }\r\n\r\n  next() {\r\n    this.goTo(this.index + 1)\r\n  }\r\n\r\n  goTo(index, data) {\r\n    if (index === this.index || this.isChanging()) return\r\n\r\n    const checkedIndex = this.checkLoop(index)\r\n    const event = this.createEvent(checkedIndex, data)\r\n\r\n    if (checkedIndex === this.index) {\r\n      this.changing = false\r\n\r\n      return\r\n    }\r\n\r\n    this.index = checkedIndex\r\n    this.options.callback(event)\r\n  }\r\n\r\n  done() {\r\n    this.changing = false\r\n\r\n    if (this.options.auto) this.startAuto()\r\n  }\r\n\r\n  // Private functions\r\n  events() {\r\n    if (!this.el) return\r\n\r\n    if (this.options.mouseSwipe) {\r\n      this.el.addEventListener('mousedown', this.touchStart)\r\n      this.el.addEventListener('mouseup', this.touchEnd)\r\n    }\r\n\r\n    this.el.addEventListener('touchstart', this.touchStart)\r\n    this.el.addEventListener('touchend', this.touchEnd)\r\n  }\r\n\r\n  touchStart(event) {\r\n    this.touch.startX = event.type === 'touchstart' ? event.touches[0].screenX : event.screenX\r\n    this.touch.startY = event.type === 'touchstart' ? event.touches[0].screenY : event.screenY\r\n  }\r\n\r\n  touchEnd(event) {\r\n    this.touch.endX = event.type === 'touchend' ? event.changedTouches[0].screenX : event.screenX\r\n    this.touch.endY = event.type === 'touchend' ? event.changedTouches[0].screenY : event.screenY\r\n\r\n    this.handleSwipe()\r\n  }\r\n\r\n  isGoingToX() {\r\n    return this.touch.endX < this.touch.startX && this.touch.startX - this.touch.endX <= this.diagonalMax || this.touch.endX > this.touch.startX && this.touch.endX - this.touch.startX <= this.diagonalMax\r\n  }\r\n\r\n  isGoingToY() {\r\n    return this.touch.endY < this.touch.startY && this.touch.startY - this.touch.endY <= this.diagonalMax || this.touch.endY > this.touch.startY && this.touch.endY - this.touch.startY <= this.diagonalMax\r\n  }\r\n\r\n  handleSwipe() {\r\n    if (this.changing) return\r\n\r\n    if (this.options.vertical) {\r\n      if (this.touch.endY < this.touch.startY && this.touch.startY - this.touch.endY >= this.options.threshold) {\r\n        if (this.isGoingToX()) this.callback(-1)\r\n      }\r\n      if (this.touch.endY > this.touch.startY && this.touch.endY - this.touch.startY >= this.options.threshold) {\r\n        if (this.isGoingToX()) this.callback(1)\r\n      }\r\n    } else {\r\n      if (this.touch.endX < this.touch.startX && this.touch.startX - this.touch.endX >= this.options.threshold) {\r\n        if (this.isGoingToY()) this.callback(-1)\r\n      }\r\n      if (this.touch.endX > this.touch.startX && this.touch.endX - this.touch.startX >= this.options.threshold) {\r\n        if (this.isGoingToY()) this.callback(1)\r\n      }\r\n    }\r\n  }\r\n\r\n  startAuto() {\r\n    if (this.intervalID) this.stopAuto()\r\n\r\n    this.intervalID = setRafInterval(this.intervalFn, this.options.interval * 1000)\r\n  }\r\n\r\n  intervalFn() {\r\n    if (this.changing) return\r\n\r\n    this.callback(-1)\r\n  }\r\n\r\n  stopAuto() {\r\n    clearRafInterval(this.intervalID)\r\n\r\n    this.intervalID = null\r\n  }\r\n\r\n  isChanging() {\r\n    if (this.changing) return true\r\n\r\n    this.changing = true\r\n\r\n    return false\r\n  }\r\n\r\n  newIndex(delta) {\r\n    return this.checkLoop(delta > 0 ? this.index - 1 : this.index + 1)\r\n  }\r\n\r\n  newRandomIndex() {\r\n    let randIndex\r\n\r\n    do {\r\n      randIndex = Math.floor(Math.random() * this.max)\r\n    } while (randIndex === this.index)\r\n\r\n    return randIndex\r\n  }\r\n\r\n  checkLoop(index) {\r\n    return index < 0 ? this.options.loop ? this.max - 1 : 0 : index > this.max - 1 ? this.options.loop ? 0 : this.max - 1 : index\r\n  }\r\n\r\n  createEvent(newIndex, data) {\r\n    let direction = newIndex > this.index ? 1 : -1\r\n\r\n    if (this.max > 2) {\r\n      if (this.index === 0 && newIndex === this.max - 1) direction = -1\r\n      else if (this.index === this.max - 1 && newIndex === 0) direction = 1\r\n    }\r\n\r\n    return {\r\n      current: newIndex,\r\n      previous: this.index,\r\n      direction,\r\n      data,\r\n      done: this.done\r\n    }\r\n  }\r\n\r\n  callback(delta) {\r\n    if (this.isChanging()) return\r\n\r\n    const index = this.options.random ? this.newRandomIndex() : this.newIndex(delta)\r\n    const event = this.createEvent(index)\r\n\r\n    if (index === this.index) {\r\n      this.changing = false\r\n\r\n      return\r\n    }\r\n\r\n    if (this.options.auto) this.stopAuto()\r\n\r\n    this.index = index\r\n    this.options.callback(event)\r\n  }\r\n}\r\n"],"names":["queue","id","ticking","tickId","opt","callback","this","max","bindMethods","defaults","el","loop","random","vertical","done","auto","interval","init","swipe","mouseSwipe","startAt","threshold","options","Object","assign","changing","length","children","index","isNaN","Math","min","intervalID","touch","startX","startY","endX","endY","diagonalMax","console","warn","intervalFn","bind","startAuto","stopAuto","touchStart","touchEnd","events","destroy","removeEventListener","getIndex","prev","goTo","next","data","isChanging","checkedIndex","checkLoop","event","createEvent","addEventListener","type","touches","screenX","screenY","changedTouches","handleSwipe","isGoingToX","isGoingToY","push","fn","lastTime","performance","now","tick","requestAnimationFrame","forEach","item","rafID","i","splice","cancelAnimationFrame","clearRafInterval","newIndex","delta","newRandomIndex","randIndex","floor","direction","current","previous"],"mappings":"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"}